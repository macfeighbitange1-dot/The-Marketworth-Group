{% extends "base.html" %}
{% block content %}

<article class="container reveal active" style="padding: 80px 0; max-width: 850px;">
    <header style="margin-bottom: 3rem;">
        <span style="color: #25d366; font-weight: 800; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 2px;">Automation Protocol 002</span>
        <h1 style="font-size: 2.8rem; margin-top: 10px; line-height: 1.1;">The High-Volume <span>WhatsApp Sales</span> Funnel.</h1>
        <p style="font-size: 1.2rem; color: #64748b; margin-top: 1.5rem;">Architecting systems that turn Meta Ad traffic into paid orders 24/7.</p>
    </header>

    <section style="margin-bottom: 3rem;">
        <h2 style="border-left: 4px solid #25d366; padding-left: 15px; margin-bottom: 1.5rem;">The Retail Bottleneck</h2>
        <p>Most Kenyan retailers lose 60% of their leads because of slow response times. If a customer clicks an ad at 9:00 PM and doesn't get a reply until 8:00 AM the next day, the "buying intent" has evaporated. This protocol uses the <strong>WhatsApp Business Cloud API</strong> to ensure the conversation starts in milliseconds.</p>
    </section>

    

    <section style="margin-bottom: 3rem; background: #f0fdf4; padding: 2rem; border-radius: 20px;">
        <h3 style="margin-bottom: 1rem; color: #166534;">The 4-Stage Automation Pillar</h3>
        <ul style="line-height: 1.8; color: #166534; list-style-type: none; padding-left: 0;">
            <li><strong>1. Direct-to-WhatsApp (CTWA):</strong> We bypass landing pages, taking the user straight from Facebook/Instagram into a chat.</li>
            <li><strong>2. Contextual Routing:</strong> The system identifies which ad the user clicked and triggers a specific product catalog.</li>
            <li><strong>3. Qualification Bot:</strong> Automated buttons filter users by size, location, and budget.</li>
            <li><strong>4. Instant Closing:</strong> Integration with M-Pesa STK Push allows the customer to pay without leaving the chat.</li>
        </ul>
    </section>

    <section style="margin-bottom: 3rem;">
        <h3 style="margin-bottom: 1rem;">System Logic (Webhook Handling)</h3>
        <p>To handle 1,000+ leads daily, the backend must be stateless and fast. Here is how we handle incoming referral data from Meta Ads:</p>
        <div style="background: #1e293b; color: #f8fafc; padding: 1.5rem; border-radius: 10px; font-family: 'Courier New', monospace; font-size: 0.9rem; overflow-x: auto;">
<pre>
# Processing an incoming Click-to-WhatsApp Lead
@app.route('/webhook', methods=['POST'])
def handle_whatsapp_lead():
    data = request.json
    referral = data['entry'][0]['changes'][0]['value']['messages'][0].get('referral')
    
    if referral and referral['headline'] == 'Flash_Sale_2026':
        # Trigger specific automated sales flow
        send_template_message(
            target=data['from'], 
            template_name='flash_sale_onboarding'
        )
    return "EVENT_RECEIVED", 200
</pre>
        </div>
    </section>

    <section style="text-align: center; background: #075e54; color: white; padding: 3rem; border-radius: 30px; margin-top: 5rem;">
        <h2 style="color: white; margin-bottom: 1rem;">Eliminate Lead Decay</h2>
        <p style="margin-bottom: 2rem; opacity: 0.9;">Stop paying for ads that don't convert. Build an automated sales engine that closes while you sleep.</p>
        <a href="https://wa.me/{{ info.whatsapp }}" class="btn-primary" style="background: #25d366; border: none; font-weight: 800;">Consult on Automation</a>
    </section>
</article>

{% endblock %}